{"platform":{"name":"debian","release":"11.3","target_id":"41138718-627e-50d8-bb7f-800dbab59f58"},"profiles":[{"name":"my_nginx","version":"0.1.0","sha256":"cc3eece45e6862f2b94e83670d0238bccdc2ee04e814ebf66aff5cbe0b54f57e","title":"InSpec Profile","maintainer":"The Authors","summary":"An InSpec Compliance Profile","license":"Apache-2.0","copyright":"The Authors","copyright_email":"you@example.com","supports":[{"platform":"os"}],"attributes":[{"name":"nginx_version_yml","options":{"type":"String","value":"1.10.3"}},{"name":"nginx_modules_yml","options":{"type":"Array","value":["http_ssl","stream_ssl","mail_ssl"]}},{"name":"root_users","options":{"type":"String","value":"root"}},{"name":"others","options":{"type":"String","value":"others"}},{"name":"file_path","options":{"type":"String","value":"/etc/nginx/nginx.conf"}}],"groups":[{"id":"controls/example.rb","controls":["nginx-version","nginx-modules","nginx-conf"]}],"controls":[{"id":"nginx-version","title":"NGINX version","desc":"The required version of NGINX should be installed.","descriptions":[{"label":"default","data":"The required version of NGINX should be installed."}],"impact":1.0,"refs":[],"tags":{},"code":"control 'nginx-version' do\n  impact 1.0\n  title 'NGINX version'\n  desc 'The required version of NGINX should be installed.'\n  describe nginx do\n    its('version') { should cmp >= input('nginx_version_yml') }\n  end\nend\n","source_location":{"line":1,"ref":"./controls/example.rb"},"waiver_data":{},"results":[{"status":"passed","code_desc":"Nginx Environment version is expected to cmp >= \"1.10.3\"","run_time":0.000330404,"start_time":"2022-05-24T19:37:55+00:00","resource_class":"nginx","resource_params":"[]","resource_id":""}]},{"id":"nginx-modules","title":"NGINX modules","desc":"The required NGINX modules should be installed are http_ssl, stream_ssl, and mail_ssl","descriptions":[{"label":"default","data":"The required NGINX modules should be installed are http_ssl, stream_ssl, and mail_ssl"}],"impact":1.0,"refs":[],"tags":{},"code":"control 'nginx-modules' do\n  title 'NGINX modules'\n  desc 'The required NGINX modules should be installed are http_ssl, stream_ssl, and mail_ssl'\n  impact 1.0\n\n  nginx_mod_control =  input('nginx_modules_yml')\n\n  describe nginx do \n    nginx_mod_control.each do |current_module|\n   #input('nginx_modules_yml').each do |current_module|\n      its('modules') { should include current_module }\n    end\n  end\nend\n","source_location":{"line":10,"ref":"./controls/example.rb"},"waiver_data":{},"results":[{"status":"passed","code_desc":"Nginx Environment modules is expected to include \"http_ssl\"","run_time":0.005858972,"start_time":"2022-05-24T19:37:56+00:00","resource_class":"nginx","resource_params":"[]","resource_id":""},{"status":"passed","code_desc":"Nginx Environment modules is expected to include \"stream_ssl\"","run_time":0.000294404,"start_time":"2022-05-24T19:37:56+00:00","resource_class":"nginx","resource_params":"[]","resource_id":""},{"status":"passed","code_desc":"Nginx Environment modules is expected to include \"mail_ssl\"","run_time":0.000144201,"start_time":"2022-05-24T19:37:56+00:00","resource_class":"nginx","resource_params":"[]","resource_id":""}]},{"id":"nginx-conf","title":"NGINX configuration","desc":"The NGINX config file should owned by root, be writable only by owner, and not writeable or and readable by others.","descriptions":[{"label":"default","data":"The NGINX config file should owned by root, be writable only by owner, and not writeable or and readable by others."}],"impact":1.0,"refs":[],"tags":{},"code":"control 'nginx-conf' do\n  title 'NGINX configuration'\n  desc 'The NGINX config file should owned by root, be writable only by owner, and not writeable or and readable by others.'\n  impact 1.0\n\n  describe file(input('file_path')) do\n    it { should be_owned_by input('root_users') }\n    it { should be_grouped_into input('root_users') }\n    it { should_not be_readable.by(input('others')) }\n    it { should_not be_writable.by(input('others')) }\n    it { should_not be_executable.by(input('others')) }\n  end\nend\n","source_location":{"line":32,"ref":"./controls/example.rb"},"waiver_data":{},"results":[{"status":"passed","code_desc":"File /etc/nginx/nginx.conf is expected to be owned by \"root\"","run_time":0.110059342,"start_time":"2022-05-24T19:37:56+00:00","resource_class":"file","resource_params":"[\"/etc/nginx/nginx.conf\"]","resource_id":""},{"status":"passed","code_desc":"File /etc/nginx/nginx.conf is expected to be grouped into \"root\"","run_time":0.011168536,"start_time":"2022-05-24T19:37:56+00:00","resource_class":"file","resource_params":"[\"/etc/nginx/nginx.conf\"]","resource_id":""},{"status":"failed","code_desc":"File /etc/nginx/nginx.conf is expected not to be readable by others","run_time":0.108066818,"start_time":"2022-05-24T19:37:56+00:00","message":"expected File /etc/nginx/nginx.conf not to be readable by others","resource_class":"file","resource_params":"[\"/etc/nginx/nginx.conf\"]","resource_id":""},{"status":"passed","code_desc":"File /etc/nginx/nginx.conf is expected not to be writable by others","run_time":0.001057613,"start_time":"2022-05-24T19:37:56+00:00","resource_class":"file","resource_params":"[\"/etc/nginx/nginx.conf\"]","resource_id":""},{"status":"passed","code_desc":"File /etc/nginx/nginx.conf is expected not to be executable by others","run_time":0.000128802,"start_time":"2022-05-24T19:37:56+00:00","resource_class":"file","resource_params":"[\"/etc/nginx/nginx.conf\"]","resource_id":""}]}],"status":"loaded","status_message":""}],"statistics":{"duration":0.543478528},"version":"5.14.0"}